<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorpresa del Día</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
		margin-top:5px;
    }
    #imagenContainer {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 250px; /* Ajusta esta altura según tus necesidades */
        margin-bottom: 1px;
        overflow: hidden; /* Asegura que la imagen no se salga del contenedor */
    }
    #imagenDelDia {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain; /* Mantiene la imagen dentro del contenedor sin deformarla */
        margin-bottom: 10px;
    }
    .icon-button {
        background-color: #25D366;
        border: none;
        color: white;
        padding: 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 20px;
        margin: 1px;
        cursor: pointer;
        border-radius: 50%;
    }
    #mensajeDescarga {
        display: none;
        margin-top: 20px;
        color: black;
        font-weight: bold;
    }
    #fechaActual {
        font-size: 18px;
        margin-bottom: 10px;
    }
    #progressContainer {
        width: 80%;
        background-color: #f3f3f3;
        margin: 20px auto;
        border-radius: 5px;
        overflow: hidden;
        display: none;
    }
    #progressBar {
        width: 0;
        height: 20px;
        background-color: #25D366;
    }
    #loadingText {
        margin-top: 10px;
        display: none;
    }
    h1 {
        margin-bottom: 2px;
		font-size:28px;
		margin-top:5px;
    }
    .misubtitulo {
        color: #000000;
        font-size: 18px;
        margin-bottom: 5px;
		margin-top:5px;
        font-style: bold;
    }
	.modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
			
        }
        .modal-content {
			background-color: #fefefe;
			margin: 15% auto;
			padding: 20px;
			border: 1px solid #888;
			width: 80%;
			max-width: 400px;
			text-align: center;
			position: relative;
			border-radius: 10px; /* Agrega bordes redondeados */
}
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
</style>
</head>
<body>
    <h1>Sorpresa del Día</h1>
    <div id="fechaActual"></div>
    <p class="misubtitulo">Descubre la bendición del día para ti</p>
    <div id="imagenContainer">
        <img id="imagenDelDia" src="https://calcutrader.com/appdemo/sorpresa.jpg" alt="Imagen del día">
    </div>
    <br>
    <i id="startBtn" class="fas fa-magic icon-button" onclick="iniciarAnimacion()"></i>
    <a id="downloadBtn" class="fas fa-download icon-button" style="display: none;" download="imagen.jpg"></a>
    <i id="shareBtn" class="fas fa-share-alt icon-button" style="display: none;" onclick="compartirApp()"></i>
   
 
   

    <div id="progressContainer">
        <div id="progressBar"></div>
    </div>
    <div id="loadingText">Cargando imágenes...</div>
	
	  <!-- Modal de alerta -->
    <div id="alertModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="cerrarModal()">&times;</span>
            <p>Imagen descargada satisfactoriamente, la puedes compartir desde tu galería.</p>
        </div>
    </div>


    <script>
        const imagenesPorDia = {
           '08-10': [
              	'https://calcutrader.com/appdemo/01.jpg',
                'https://calcutrader.com/appdemo/02.jpg',
                'https://calcutrader.com/appdemo/03.jpg',
				'https://calcutrader.com/appdemo/04.jpg',
                'https://calcutrader.com/appdemo/05.jpg',
				'https://calcutrader.com/appdemo/06.jpg',
                'https://calcutrader.com/appdemo/07.jpg',
				'https://calcutrader.com/appdemo/08.jpg',
                'https://calcutrader.com/appdemo/09.jpg',
				
                'https://calcutrader.com/appdemo/10.jpg'
            ],
            '04-06': [
                'https://calcutrader.com/proyecto/11.jpg',
                'https://calcutrader.com/proyecto/20.jpg'
            ],
            '05-06': [
                'https://calcutrader.com/proyecto/dia3/01.jpg',
                'https://calcutrader.com/proyecto/dia3/10.jpg'
            ],
            '06-06': [
                'https://calcutrader.com/proyecto/dia4/01.jpg',
                'https://calcutrader.com/proyecto/dia4/10.jpg'
            ],
            '07-06': [
                'https://calcutrader.com/proyecto/dia5/01.jpg',
                'https://calcutrader.com/proyecto/dia5/10.jpg'
            ],
            '08-06': [
                'https://calcutrader.com/proyecto/dia6/01.jpg',
                'https://calcutrader.com/proyecto/dia6/10.jpg'
            ],
            '09-06': [
                'https://calcutrader.com/proyecto/dia7/01.jpg',
                'https://calcutrader.com/proyecto/dia7/10.jpg'
            ]
        };

        let imagenesCargadas = 0;
        let animacionInterval;

			function obtenerFechaActual() {
			const hoy = new Date();
			const opcionesFecha = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
			let fechaFormateada = hoy.toLocaleDateString(undefined, opcionesFecha);
			// Capitalizar la primera letra del día de la semana
			fechaFormateada = fechaFormateada.replace(/^\w/, (c) => c.toUpperCase());
			return fechaFormateada;
		}


		function obtenerFechaParaImagen() {
			const hoy = new Date();
			const dia = hoy.getDate().toString().padStart(2, '0');
			const mes = (hoy.getMonth() + 1).toString().padStart(2, '0');
			return `${dia}-${mes}`;
		}


        function iniciarAnimacion() {
            const fechaActual = obtenerFechaParaImagen();
            const imagenes = imagenesPorDia[fechaActual];
            if (imagenes) {
                cargarImagenes(imagenes, () => {
                    if (imagenesCargadas < imagenes.length) {
                        alert('Las imágenes aún se están cargando, por favor espera.');
                        return;
                    }
                    const imgElement = document.getElementById('imagenDelDia');
                    imgElement.style.display = 'block';
                    let index = 0;
                    animacionInterval = setInterval(() => {
                        imgElement.src = imagenes[index];
                        index = (index + 1) % imagenes.length;
                    }, 100); // Cambia la imagen cada 100 ms

                    setTimeout(detenerAnimacion, 3000); // Detener la animación después de 10 segundos
                });
            } else {
                alert('No hay imágenes disponibles para hoy.');
            }
        }

        function cargarImagenes(imagenes, callback) {
            imagenesCargadas = 0;
            const progressBar = document.getElementById('progressBar');
            const loadingText = document.getElementById('loadingText');
            progressBar.style.width = '0%';
            progressBar.parentElement.style.display = 'block';
            loadingText.style.display = 'block';

            imagenes.forEach((url, index) => {
                const img = new Image();
                img.src = url;
                img.onload = () => {
                    imagenesCargadas++;
                    const progress = (imagenesCargadas / imagenes.length) * 100;
                    progressBar.style.width = `${progress}%`;

                    if (imagenesCargadas === imagenes.length) {
                        setTimeout(() => {
                            progressBar.parentElement.style.display = 'none';
                            loadingText.style.display = 'none';
                            callback();
                        }, 500);
                    }
                };
            });
        }

       function detenerAnimacion() {
			clearInterval(animacionInterval);
			const imgElement = document.getElementById('imagenDelDia');
			const fechaActual = obtenerFechaParaImagen();
			const imagenes = imagenesPorDia[fechaActual];
			const indiceFinal = Math.floor(Math.random() * imagenes.length);
			imgElement.src = imagenes[indiceFinal];
			actualizarBotonDescarga(imagenes[indiceFinal]); // Actualiza el botón de descarga
			document.getElementById('downloadBtn').style.display = 'inline-block';
			document.getElementById('shareBtn').style.display = 'inline-block';
		}


		  function actualizarBotonDescarga(imagenUrl) {
            const downloadBtn = document.getElementById('downloadBtn');
            const alertModal = document.getElementById('alertModal');
            const closeModal = document.querySelector('.close');

            // Actualizar el href y el nombre de descarga del botón
            downloadBtn.href = imagenUrl;
            downloadBtn.download = imagenUrl.split('/').pop();

            // Agregar event listener al botón para mostrar el modal de alerta
            downloadBtn.onclick = () => {
                alertModal.style.display = 'flex';

                // Ocultar el modal después de 5 segundos
                setTimeout(() => {
                    alertModal.style.display = 'none';
                }, 4000);
            };

            // Agregar event listener al botón de cierre del modal
            closeModal.onclick = () => {
                alertModal.style.display = 'none';
            };

            // Ocultar el modal si se hace clic fuera del contenido
            window.onclick = (event) => {
                if (event.target === alertModal) {
                    alertModal.style.display = 'none';
                }
            };
        }

        // Ejemplo de cómo llamar a actualizarBotonDescarga cuando se actualiza la imagen
        const nuevaImagenUrl = 'url_de_la_nueva_imagen';
        actualizarBotonDescarga(nuevaImagenUrl);

		

        function compartirApp() {
            const url = encodeURIComponent(window.location.href);
            const mensaje = `\n\nTe recomiendo esta increíble aplicación para que descubras cuál es tu bendición diaria.Descárgala aquí:👇👇👇\n\nhttps://play.google.com/store/apps/details?id=com.fgol.HungrySharkEvolution.`;
            window.open(`https://api.whatsapp.com/send?text=${mensaje}`, '_blank');
        }

        document.getElementById('fechaActual').textContent = obtenerFechaActual();

    </script>
</body>
</html>
