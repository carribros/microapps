<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorpresa del D칤a</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
		margin-top:5px;
    }
    #imagenContainer {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 250px; /* Ajusta esta altura seg칰n tus necesidades */
        margin-bottom: 1px;
        overflow: hidden; /* Asegura que la imagen no se salga del contenedor */
    }
    #imagenDelDia {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain; /* Mantiene la imagen dentro del contenedor sin deformarla */
        margin-bottom: 10px;
    }
    .icon-button {
        background-color: #25D366;
        border: none;
        color: white;
        padding: 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 20px;
        margin: 1px;
        cursor: pointer;
        border-radius: 50%;
    }
    #mensajeDescarga {
        display: none;
        margin-top: 20px;
        color: black;
        font-weight: bold;
    }
    #fechaActual {
        font-size: 18px;
        margin-bottom: 10px;
    }
    #progressContainer {
        width: 80%;
        background-color: #f3f3f3;
        margin: 20px auto;
        border-radius: 5px;
        overflow: hidden;
        display: none;
    }
    #progressBar {
        width: 0;
        height: 20px;
        background-color: #25D366;
    }
    #loadingText {
        margin-top: 10px;
        display: none;
    }
    h1 {
        margin-bottom: 2px;
		font-size:28px;
		margin-top:5px;
    }
    .misubtitulo {
        color: #000000;
        font-size: 18px;
        margin-bottom: 5px;
		margin-top:5px;
        font-style: bold;
    }
	.modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
			
        }
        .modal-content {
			background-color: #fefefe;
			margin: 15% auto;
			padding: 20px;
			border: 1px solid #888;
			width: 80%;
			max-width: 400px;
			text-align: center;
			position: relative;
			border-radius: 10px; /* Agrega bordes redondeados */
}
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
</style>
</head><body>
    <h1>Sorpresa del D칤a</h1>
    <div id="fechaActual"></div>
    <p class="misubtitulo">Descubre la bendici칩n del d칤a para ti</p>
    <div id="imagenContainer">
        <img id="imagenDelDia" src="https://calcutrader.com/appdemo/sorpresa.jpg" alt="Imagen del d칤a">
    </div>
    <br>
    <i id="startBtn" class="fas fa-magic icon-button" onclick="iniciarAnimacion()"></i>
    <a id="downloadBtn" class="fas fa-download icon-button" style="display: none;" onclick="descargarImagen()"></a>
    <i id="shareBtn" class="fas fa-share-alt icon-button" style="display: none;" onclick="compartirApp()"></i>

    <div id="progressContainer">
        <div id="progressBar"></div>
    </div>
    <div id="loadingText">Cargando im치genes...</div>

    <div id="alertModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="cerrarModal()">&times;</span>
            <p>Imagen descargada satisfactoriamente, la puedes compartir desde tu galer칤a.</p>
        </div>
    </div>

    <script>
        const imagenesPorDia = {
            '09-10': [
                'https://calcutrader.com/appdemo/01.jpg',
                'https://calcutrader.com/appdemo/02.jpg',
                'https://calcutrader.com/appdemo/03.jpg',
                'https://calcutrader.com/appdemo/04.jpg',
                'https://calcutrader.com/appdemo/05.jpg',
                'https://calcutrader.com/appdemo/06.jpg',
                'https://calcutrader.com/appdemo/07.jpg',
                'https://calcutrader.com/appdemo/08.jpg',
                'https://calcutrader.com/appdemo/09.jpg',
                'https://calcutrader.com/appdemo/10.jpg'
            ],
            // ... (mant칠n las otras fechas)
        };

        let imagenesCargadas = 0;
        let animacionInterval;
        let imagenActual;

        function obtenerFechaActual() {
            const hoy = new Date();
            const opcionesFecha = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            let fechaFormateada = hoy.toLocaleDateString(undefined, opcionesFecha);
            return fechaFormateada.replace(/^\w/, (c) => c.toUpperCase());
        }

        function obtenerFechaParaImagen() {
            const hoy = new Date();
            const dia = hoy.getDate().toString().padStart(2, '0');
            const mes = (hoy.getMonth() + 1).toString().padStart(2, '0');
            return `${dia}-${mes}`;
        }

        function iniciarAnimacion() {
            const fechaActual = obtenerFechaParaImagen();
            const imagenes = imagenesPorDia[fechaActual];
            if (imagenes) {
                cargarImagenes(imagenes, () => {
                    if (imagenesCargadas < imagenes.length) {
                        alert('Las im치genes a칰n se est치n cargando, por favor espera.');
                        return;
                    }
                    const imgElement = document.getElementById('imagenDelDia');
                    imgElement.style.display = 'block';
                    let index = 0;
                    animacionInterval = setInterval(() => {
                        imgElement.src = imagenes[index];
                        index = (index + 1) % imagenes.length;
                    }, 100);

                    setTimeout(detenerAnimacion, 3000);
                });
            } else {
                alert('No hay im치genes disponibles para hoy.');
            }
        }

        function cargarImagenes(imagenes, callback) {
            // ... (mant칠n la funci칩n cargarImagenes sin cambios)
        }

        function detenerAnimacion() {
            clearInterval(animacionInterval);
            const imgElement = document.getElementById('imagenDelDia');
            const fechaActual = obtenerFechaParaImagen();
            const imagenes = imagenesPorDia[fechaActual];
            const indiceFinal = Math.floor(Math.random() * imagenes.length);
            imagenActual = imagenes[indiceFinal];
            imgElement.src = imagenActual;
            document.getElementById('downloadBtn').style.display = 'inline-block';
            document.getElementById('shareBtn').style.display = 'inline-block';
        }

        function descargarImagen() {
            if (imagenActual) {
                // Enviar un mensaje al WebView para manejar la descarga
                if (window.AndroidInterface) {
                    window.AndroidInterface.descargarImagen(imagenActual);
                } else if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.descargarImagen) {
                    window.webkit.messageHandlers.descargarImagen.postMessage(imagenActual);
                } else {
                    // Fallback para navegadores web
                    window.open(imagenActual, '_blank');
                }
                mostrarModal();
            }
        }

        function mostrarModal() {
            document.getElementById('alertModal').style.display = 'flex';
            setTimeout(() => {
                document.getElementById('alertModal').style.display = 'none';
            }, 4000);
        }

        function cerrarModal() {
            document.getElementById('alertModal').style.display = 'none';
        }

        function compartirApp() {
            const mensaje = `\n\nTe recomiendo esta incre칤ble aplicaci칩n para que descubras cu치l es tu bendici칩n diaria. Desc치rgala aqu칤:游녢游녢游녢\n\nhttps://play.google.com/store/apps/details?id=com.fgol.HungrySharkEvolution.`;
            if (window.AndroidInterface) {
                window.AndroidInterface.compartirApp(mensaje);
            } else if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.compartirApp) {
                window.webkit.messageHandlers.compartirApp.postMessage(mensaje);
            } else {
                // Fallback para navegadores web
                window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(mensaje)}`, '_blank');
            }
        }

        document.getElementById('fechaActual').textContent = obtenerFechaActual();
    </script>
</body>
</html>